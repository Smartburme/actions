<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - Aung Myo Kyaw</title>
  <link rel="icon" href="assets/logo.svg" />
  <link rel="stylesheet" href="css/style.css" />
  <style>
    .password-container {
      position: relative;
    }
    
    .toggle-password {
      position: absolute;
      right: 12px;
      top: 42px;
      background: none;
      border: none;
      color: var(--muted);
      cursor: pointer;
      padding: 4px;
    }
    
    .toggle-password:hover {
      color: var(--sea);
    }
    
    .auth-message {
      padding: 10px;
      border-radius: var(--radius);
      margin-top: 10px;
      display: none;
    }
    
    .success {
      background: rgba(0, 150, 199, 0.2);
      color: var(--sea);
      border: 1px solid var(--sea);
    }
    
    .error {
      background: rgba(239, 71, 111, 0.2);
      color: var(--danger);
      border: 1px solid var(--danger);
    }
  </style>
</head>
<body class="theme-day auth-page">
  <main class="auth card">
    <div style="text-align: center; margin-bottom: 20px;">
      <img src="assets/logo.svg" alt="Logo" style="width: 60px; height: 60px;">
      <h2 style="margin-top: 10px;">Login</h2>
    </div>
    
    <div id="auth-message" class="auth-message"></div>
    
    <label>Email
      <input id="login-email" type="email" placeholder="you@example.com" />
    </label>
    
    <label>Password
      <div class="password-container">
        <input id="login-password" type="password" placeholder="••••••••" />
        <button type="button" id="toggle-password" class="toggle-password">👁️</button>
      </div>
    </label>
    
    <button id="do-login" class="btn">Login</button>
    
    <div style="text-align: center; margin: 15px 0; position: relative;">
      <hr style="border: none; border-top: 1px solid var(--muted); opacity: 0.3;">
      <span style="background: var(--card); padding: 0 10px; position: absolute; top: -10px; left: 50%; transform: translateX(-50%); color: var(--muted); font-size: 0.9rem;">သို့မဟုတ်</span>
    </div>
    
    <button id="google-login" class="btn outline">Google ဖြင့်ဝင်မည်</button>
    
    <div class="auth-links" style="display: flex; justify-content: space-between; margin-top: 20px;">
      <a class="link" href="reset.html">Password မေ့နေပါသလား?</a>
      <a class="link" href="register.html">Account အသစ်ဖွင့်ရန်</a>
    </div>
    
    <a class="link" href="index.html" style="display: block; text-align: center; margin-top: 15px;">မူလစာမျက်နှာသို့</a>
  </main>

  <script src="js/firebase.config.js"></script>
  <script>
    // Firebase initialization
    const app = firebase.initializeApp(firebaseConfig);
    
    // Password visibility toggle
    const togglePassword = document.getElementById('toggle-password');
    const passwordInput = document.getElementById('login-password');
    const authMessage = document.getElementById('auth-message');
    
    togglePassword.addEventListener('click', function() {
      const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
      passwordInput.setAttribute('type', type);
      this.textContent = type === 'password' ? '👁️' : '🔒';
    });
    
    // Show message function
    function showMessage(message, type) {
      authMessage.textContent = message;
      authMessage.className = 'auth-message ' + type;
      authMessage.style.display = 'block';
      
      // Auto hide after 5 seconds
      setTimeout(() => {
        authMessage.style.display = 'none';
      }, 5000);
    }
    
    // Login function
    document.getElementById('do-login').addEventListener('click', () => {
      const email = document.getElementById('login-email').value;
      const password = document.getElementById('login-password').value;
      
      if (!email || !password) {
        showMessage('ကျေးဇူးပြု၍ အီးမေးလ်နှင့် password ထည့်ပါ', 'error');
        return;
      }
      
      // Show loading state
      const loginBtn = document.getElementById('do-login');
      const originalText = loginBtn.textContent;
      loginBtn.textContent = 'လုပ်ဆောင်နေသည်...';
      loginBtn.disabled = true;
      
      // Simulate login process (replace with actual Firebase auth)
      setTimeout(() => {
        // For demo purposes - in real app, use Firebase authentication
        if (email === 'demo@example.com' && password === 'password') {
          showMessage('Login အောင်မြင်ပါသည်! Dashboard သို့ညွှန့်ပို့နေသည်...', 'success');
          
          // Redirect to dashboard after successful login
          setTimeout(() => {
            window.location.href = "dashboard.html";
          }, 2000);
        } else {
          showMessage('Login မအောင်မြင်ပါ။ အီးမေးလ် (သို့) password မှားယွင်းနေပါသည်။', 'error');
          
          // Reset button state
          loginBtn.textContent = originalText;
          loginBtn.disabled = false;
        }
      }, 1500);
    });
    
    // Google login
    document.getElementById('google-login').addEventListener('click', () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      
      // Show loading state
      const googleBtn = document.getElementById('google-login');
      const originalText = googleBtn.textContent;
      googleBtn.textContent = 'လုပ်ဆောင်နေသည်...';
      googleBtn.disabled = true;
      
      firebase.auth()
        .signInWithPopup(provider)
        .then((result) => {
          // Google sign-in successful
          showMessage('Google Login အောင်မြင်ပါသည်! Dashboard သို့ညွှန့်ပို့နေသည်...', 'success');
          
          // Redirect to dashboard after successful login
          setTimeout(() => {
            window.location.href = "dashboard.html";
          }, 2000);
        }).catch((error) => {
          console.error('Error:', error);
          showMessage('Google login ဝင်ရာတွင် အမှားတစ်ခုဖြစ်နေပါသည်', 'error');
          
          // Reset button state
          googleBtn.textContent = originalText;
          googleBtn.disabled = false;
        });
    });
    
    // Check if user is already logged in (demo only)
    window.addEventListener('load', () => {
      // In a real app, you would check Firebase auth state
      const isLoggedIn = localStorage.getItem('isLoggedIn');
      if (isLoggedIn) {
        showMessage('သင့်အား auto login ဝင်ထားပြီးဖြစ်သည်။', 'success');
        setTimeout(() => {
          window.location.href = "dashboard.html";
        }, 2000);
      }
    });
  </script>
</body>
</html>
